import java.time.chrono.IsoChronology;
import java.util.Random;

public class MathTools {

	public static int generatePrime(int max) {
		boolean created=false;
		Random r = new Random();
		int current = r.nextInt(max);
		while(!created) {
			if(isPrime(current)) {
				return current;
			}
			current++;
		}
		return 2;
		
	}
	private static  boolean isPrime(int number) {
		  for (int i = 2; i < number; i++) {
		        if (number % i == 0) {
		            return false;
		        }
		    }
		    return true;
	}
	public static int genE(int phi,int initial) {
		
		Random random= new Random();
		while(true) {
			int e=random.nextInt(phi-initial)+initial;
			if(coprime(e, phi)) {
				return e;
			}
		}

	
	}
	public static int genPrivateKey(int e,int phi) {
		BigInteger bi = BigInteger.valueOf(e);
		return modInverse(e, phi);
	}
	private static int modInverse(int e, int phi) 
	{ 
	    e = e%phi; 
	    for (int d=phi-1; d<1; d--) {
	       if ((e*d) % phi == 1) {
	          return d; 
	       }
	    }
	    return 1;
	} 
	 private static int __gcd(int a, int b) 
	    { 
	      
	        if (a == 0 || b == 0) 
	            return 0; 
	          
	    
	        if (a == b) 
	            return a; 
	          
	  
	        if (a > b) 
	            return __gcd(a-b, b); 
	                  
	        return __gcd(a, b-a); 
	    } 
	      
	   
	    public static boolean coprime(int a, int b) { 
	          
	        if ( __gcd(a, b) == 1) {
	        	return true;
	        }else {
	        	return false;
	        }
	         
	    } 
}
